<project name="modernize" default="jar">
  <description>
    Modernize lib package.
  </description>

  <property name="build.dir" location="classes"/>
  <property name="deps.dir" location="/Users/pjt/all_docs/software/clojure/cpath"/>
  <property name="source.dir" location="."/>
  <property name="modernize.jar" location="modernize.jar"/>

  <target name="clean" description="Remove generated files">
    <delete dir="${build.dir}"/>
  </target>

  <target name="init">
    <tstamp/>
    <mkdir dir="${build.dir}"/>
  </target>

  <target name="compile" depends="init" description="Compile sources">
    <java classname="clojure.lang.Compile">
      <classpath>
        <path location="${build.dir}"/>
        <path location="${source.dir}"/>
        <fileset dir="${deps.dir}">
          <include name="*.jar"/>
        </fileset>
        <dirset dir="${deps.dir}">
         <include name="*"/>
        </dirset>
      </classpath>
      <sysproperty key="clojure.compile.path" value="${build.dir}"/>
      <arg value="modernize"/>
    </java>
  </target>

  <target name="jar" description="Create jar file" depends="compile">
    <jar jarfile="${modernize.jar}">
      <path location="LICENSE"/>
      <fileset dir="${build.dir}" includes="**/*.class"/>
      <manifest>
         <attribute name="Main-Class" value="modernize"/>
         <attribute name="Class-Path" value="libs/clojure.jar libs/clojure-contrib.jar"/>
      </manifest>
    </jar>
  </target>

</project>
